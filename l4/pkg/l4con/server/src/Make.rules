# -*- Makefile -*-

TARGET		= con
DEFAULT_RELOC	= 0x00b00000
SYSTEMS		= x86-l4v2 x86-l4x0

PRIVATE_INCDIR	= ../../include
LIBS		= -ldsi -linput \
		  -L../con_hw/OBJ-$(SYSTEM) -lcon_hw \
		  -L../con_yuv2rgb/OBJ-$(SYSTEM) -lcon_yuv2rgb \
		  -lpci -lio -lomega0
SRC_C		= main.c pslim.c ev.c vc.c dsi_vc.c
CPPFLAGS	+= -DL4_MAX_RPC_STRING_DOPES=3 -DDEBUG

OBJS		+= font.o

CLIENTIDL	= con.idl stream.idl
SERVERIDL	= con.idl

all::

vpath %.psf $(PKGDIR)/server/src

%.o: %.psf
	$(COMP_MESSAGE)
	$(VERBOSE)$(LD) -r --oformat default -o $@ -b binary $^

font.psf: lat0-14.psf
	@ln -s $? $@
