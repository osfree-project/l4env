\chapter{CORBA Environment}
\label{app:corba_env}

\section{L4 version 2 and Fiasco}

\subsubsection{Client side environment}
\begin{verbatim}
typedef struct CORBA_Environment
{
  dice_CORBA_exception_type _exception;
  union
  {
    void *param;
    l4_uint32_t ipc_error;
	l4_uint32_t sched_bits;
  } _p;

  l4_timeout_t timeout;
  l4_fpage_t rcv_fpage;
  l4_utcb_t *utcb;
  dice_malloc_func malloc;
  dice_free_func free;
} CORBA_Environment;
\end{verbatim}

\subsubsection{Server side environment}
\begin{verbatim}
typedef struct CORBA_Server_Environment
{
  dice_CORBA_exception_type _exception;
  union
  {
    void *param;
    l4_uint32_t ipc_error;
	l4_uint32_t sched_bits;
  } _p;

  l4_timeout_t timeout;
  l4_fpage_t rcv_fpage;
  l4_utcb_t *utcb;
  dice_malloc_func malloc;
  dice_free_func free;

  // server specific
  CORBA_Object_base partner;
  void* user_data;
  void* ptrs[DICE_PTRS_MAX];
  unsigned short ptrs_cur;
} CORBA_Server_Environment;
\end{verbatim}

\section{L4 experimental version X.2}

\subsubsection{Client side environment}
\begin{verbatim}
typedef struct CORBA_Environment
{
  dice_CORBA_exception_type _exception;
  union
  {
    void *param;
    L4_Word32_t ipc_error;
	L4_Word32_t sched_bits;
  } _p;

  L4_Time_t timeout;
  L4_Fpage_t rcv_fpage;
  dice_malloc_func malloc;
  dice_free_func free;
} CORBA_Environment;
\end{verbatim}

\subsubsection{Server side environment}
\begin{verbatim}
typedef struct CORBA_Server_Environment
{
  dice_CORBA_exception_type _exception;
  union
  {
    void *param;
    L4_Word32_t ipc_error;
	L4_Word32_t sched_bits;
  } _p;

  L4_Time_t timeout;
  L4_Fpage_t rcv_fpage;
  dice_malloc_func malloc;
  dice_free_func free;

  // server specific
  CORBA_Object_base partner;
  void* user_data;
  void* ptrs[DICE_PTRS_MAX];
  unsigned short ptrs_cur;
} CORBA_Server_Environment;
\end{verbatim}

\section{Linux sockets}

\subsubsection{Client side environment}
\begin{verbatim}
typedef struct CORBA_Environment
{
  dice_CORBA_exception_type _exception;
  void *param;

  in_port_t srv_port;
  int cur_socket;
  void* user_data;
  dice_malloc_func malloc;
  dice_free_func free;
  void* ptrs[DICE_PTRS_MAX];
  unsigned short ptrs_cur;

  struct timeval receive_timeout;
} CORBA_Environment;
\end{verbatim}

\subsubsection{Server side environment}
\begin{verbatim}
#define CORBA_Server_Environment CORBA_Environment
\end{verbatim}

